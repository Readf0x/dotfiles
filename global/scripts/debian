#!/usr/bin/env fish

set -l image '[debian]
image=debian:testing
additional_packages="hyfetch bat ripgrep jq"'

if test "$VENDOR" = debian
  echo "Already in container"
  exit 1
end
if podman container exists debian
	set -l command "distrobox enter debian"
	if set -q SSH_CONNECTION
		set command $command' --additional-flags --env SSH_CONNECTION=$SSH_CONNECTION'
	end
  if not eval $command
    podman rm debian
		printf "%s" "$image" | distrobox assemble create --file /dev/stdin
	end
else
	printf "%s" "$image" | distrobox assemble create --file /dev/stdin
end

